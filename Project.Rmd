---
title: 'Statistical Learning Project'
author: 'Ammar Hasan'
date: '11 November 2018'
toc: true
fig_caption: yes

header-includes:
- \usepackage{pdflscape}
- \newcommand{\blandscape}{\begin{landscape}}
- \newcommand{\elandscape}{\end{landscape}}

output: bookdown::pdf_document2
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = T, results = 'markup', message = F)

# Load packages
library(nclSLR)
library(knitr)

# Load the data
data(Boston, package='nclSLR')

# Table function with rounding (uses kable)
table = function(dataset, cap, dp = 3){
  kable(format(round(dataset, dp), nsmall = dp), caption = cap)
}

```

\newpage

# Introduction 

This report summaries the steps undertaken to produce and evaluate linear regression models of the value of housing in Boston Standard Metropolitan to predict the value of logarithmic crime rate (lcrim) using other variables. The model would be built after exploratory and unsupervised statistical analysis of the data which is carried first to gain an understanding on the data characteristics and structure before hand. The models would be build using both sub-setting (best fit and step wise) and regularisation methods (LASSO and Ridge Fit) methods, these methods will be compared using k fold cross validation.

Any output (tables and plots) is placed in the Appendix at the end of the report with the R code that generated it, the description and analysis of the methods and their output is found in the document body which cross references the appendix content. Values in tables and other numerical results are corrected to 3 decimal places unless stated otherwise.

# Exploratory Data Analysis

Before building a linear model, it is wise to first understand the overall structure of the data itself to get a feeling for the data characteristics and how the variables relate to one another - especially how they relate to the response variable (lcrime).

## Data Spread and Location 

To analyse the distribution of the data, the quantiles and means will be examined. In particular, this part of the report will examine outliers, scale, consistency and certainty. 

### Mean Vector

Using the col means functions a vector of mean averages can be produced for all the predictors and the response variables in the Boston data-set. 

The returned table (transposed) is in table \@ref(tab:mean-vector) in Appendix A.2, and shows that the means are well spread out from one another, which suggests a difference in the nature of the measurements.

Examining the structure of the variables in the Boston data set using the ?Boston confirms that the nature of the measurements vary from Full-value property-tax rate per $10,000 for tax to Nitrogen oxides parts per 10 million for nox for instance, which obviously suggests that the measurements cannot be directly compared scale to scale (standarisation might be required).

### Box Plot and Quantiles

As previously stated in the previous section, the variables are of different natures and scales, hence any scale to scale comparsion needs standarisation. To standardise the data a scale transform was applied using the base R scale() function, and using the boxplot base function the plot in figure \@ref(fig:box-plot) is generated. 

The following stands out of the plot:

* black, rm, zn and medv predictor variables have significantly more outliers than the other variables.And hence more uncertain and also their averages can get skewed.

* chas predictor variable semms to have a very tight ranges that are practicaly identical. This is because this is a binary variable.

* zn, rad and tax predictor variables have a short Q1 to Q2 range compared to the Q2 to Q3 range, suggesting that the lower values of the data are very tightly clustered. black has the opposite problem.

* rm, lstat, mdev and ptratio have long minimum and maximum ranges in comparision to their IQR ranges, and hence more exterme values. This means that rheir averages can get skewed.

## Data Relationships 

This section of the report will look into how the variables (predictors and response) in bivariate data relate and interact using numerical correlation matricies and graphic pairs plot

### Pairs Plot 

The following relationships stick out when observing the pairs plot for the response against other varibles in figure \@ref(fig:pairs-plot):

* Relationships/correlation with lcrime:
    + age and medv has a moderate negative relationship with lcrime 
    + nox and lstat has a strong/moderate positive relationship with lcrim
    + rm and zn both have weak/moderate negative relationships with lcrime
    + tax, rad, pratio, indus and black appear to have unclear correlation
    
* Predictor variables relationships: 
    - Some predictors have strong relations with one another: rm has a strong negative relationship with lstat but a strong positive one with medv. medv and lstat also have a strong negative relationship

* Chas (river dummy variable) and disf (distance to boston employment centered) appear to have values in levels and are also diffuclt to analyse in a pairs plot


### Correlation Matricies

The correlation matrix in table \@ref(tab:cor-matrix) confirms the findings of the previous section but also helps clarify some of relationships that were unclear before: 

* Chas has a very weak relationship with lcrime, and a weak or very weak relationship with most other variables.
* disf has a moderate negative relationship with lcrime, a strong/moderate negative relationship with indus and a positive moderate relation with zn
* Tax and rad have strong relationships with lcrime that were difficult to spot before due to irregularities in their plots. Moreover, indus has a moderate positive relationship with lcrime and ptartio a weak positive one.
* Tax and rad have a very strong positive relationship

### Data Relationships Summary

To summarise, it seems that the relationships suggest that there are a couple of variables that might have a strong impact to model (e.g. tax). Moreover, the relationships also suggest that many will be subsetted due to relationships that can be repsented with other variables(e.g. rad), or very poor relationships with all variables (e.g. chas).

\newpage

# Unsupervised Learning

This section looks into apply unsupervised learning techinques to help undertanding patterns and structures in the data to help understand their effects on the model. In this report, Principle Component Analysis will be used to help find which set of predictors cause the most variation on the data to help with model coefficient interpretation and gaining an understanding of which predictors contribute to the model. 

## Principle Component Analysis

### Variation Proportions

Table \@ref(tab:pca-summary) shows the summary of Principle Component Analysis run on the data, showing the variance each principle contributes to and the accumulation of it. The summary shows that the first component contributed to 50% of the variance, and the first 4 contribute to 70%. Since the first 3 contribute to 70% and also where the variation curve in the scree plot in \@ref(fig:scree-plot) diminishes for a second time. 


### Component Interpretation (According to Table \@ref(tab:pca-comps))

#### Component 1

Dominated by positive lcrime, tax, indus and nox. This means that it represents areas with large non-retail business but high crime and nitrogen oxide pollution.

#### Component 2

Dominated by negative rm and medv, meaning that it represents less median house values and number of rooms.

#### Component 3

Dominated high accessibility highways, tax rate and residual areas.

#### Plot

A plot of the observations scores for component 1 vs component2 is shown in figure \@ref(fig:pca-plot) shows most observations score high for component 2 but are more varied for component 1. Meaning that most observations have relative low medain house value and number of rooms, but a varied crime, pollution and non-retail business.

\newpage

# Supervised Learning (Linear Model)

\newpage

# Appendix 

This section contains all supplementary material and is divided into three sections (Tables, Plots and Abbreviations). The code required to generate the supplementary material is also included

## A.1 Abbrevations and Shorthands

## Variable Shorthands

lcrim
Natural logarithm of the per capita crime rate by town.

zn
Proportion of residential land zoned for lots over 25,000 sq.ft.

indus
Proportion of non-retail business acres per town.

chas
Charles River dummy variable (=1 if tract bounds river; =0 otherwise).

nox
Nitrogen oxides concentration (parts per 10 million).

rm
Average number of rooms per dwelling.

age
Proportion of owner-occupied units built prior to 1940.

disf
A numerical vector representing an ordered categorical variable with four levels depending on the weighted mean of the distances to five Boston employment centres (=1 if distance < 2.5, =2 if 2.5 <= distance < 5, =3 if 5 <= distance < 7.5, =4 if distance >= 7.5).

rad
Index of accessibility to radial highways.

tax
Full-value property-tax rate per $10,000.

pratio
Pupil-teacher ratio by town.

black
1000(Bk - 0.63)^2 where Bk is the proportion of blacks by town.

lstat
Lower status of the population (percent).

medv
Median value of owner-occupied homes in $1000s.

\newpage

## A.2 Tables 

### Code to Generate Table \@ref(tab:mean-vector) (Transposed and Correct to 3DP)
```{r mean-vector}
table(colMeans(Boston), '')
```

\blandscape

### Code to Generate Table \@ref(tab:cor-matrix) (Correct to 3DP)
```{r cor-matrix}
table(cor(Boston), 'Correlation Matrix (3DP)')
```

\newpage

### Code to Generate Table \@ref(tab:pca-summary) (Correct to 3DP)
```{r pca-summary}
# Perform PCA based on the standardised data (means and data nature vary)
pca = prcomp(Boston, scale=TRUE)
table(summary(pca)$importance, 'PCA Summary (Contribution to Variation)')
```

### Code to Generate Table \@ref(tab:pca-comps) (Correct to 3DP)
```{r pca-comps}
# List PC 1, 2 and 3 
table(pca$rotation[,1:3], 'PCA Components')
```

\elandscape

\newpage

## A.3 Plots

### Code to Generate Figure \@ref(fig:box-plot)
```{r box-plot, fig.cap='Box Plot'}
# scale transforms to deal with the variation in the nature of the measurements
boxplot(scale(Boston), cex.axis=0.6)
```

\blandscape

\newpage

### Code to Generate Figure \@ref(fig:pairs-plot)
```{r pairs-plot, fig.cap='Pairs Plot'}
pairs(Boston, cex=0.0005)
```

\elandscape

\newpage

### Code to Generate Figure \@ref(fig:scree-plot)
```{r scree-plot, fig.cap='Scree Plot'}
plot(pca, type='l', main='Scree Plot for Boston Housing Values')
title(xlab='Principle Component number')
```

### Code to Generate Figure \@ref(fig:pca-plot)
```{r pca-plot, fig.cap='PCA Plot'}
# Plot PCA 1 against PCA 2
plot(pca$x[,1], pca$x[,2], main ="Principle Component 1 vs 2 for Boston Housing Values",
     xlab="Component 1", ylab="Component 2")
```